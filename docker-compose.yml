services:
  application:
    read_only: true
    container_name: racoder
    build: .
    image: paulgalow/racoder
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      NODE_ENV: production
      HTTP_PORT: 3000
      # See: https://en.everybodywiki.com/List_of_BBC_radio_stream_URLs
      INPUT_STREAM: 'https://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/nonuk/sbr_low/ak/bbc_radio_four_extra.m3u8'
      OUTPUT_PATH: '/bbc-radio-4-extra-test'
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:3000/healthcheck"]
      interval: 1m30s
      timeout: 20s
      retries: 3
      start_period: 10s
    cap_drop:
      - ALL

networks:
  default: